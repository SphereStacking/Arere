---
title: 設定スキーマ
description: プラグインの設定スキーマの定義方法
---

# 設定スキーマ

プラグインはユーザーがカスタマイズ可能な設定を持つことができます。Zodを使ってスキーマを定義します。

## スキーマの定義

`definePlugin()` の `configSchema` プロパティでスキーマを定義します：

```typescript
// src/index.ts
import { definePlugin } from 'arere'
import { z } from 'zod'

export default definePlugin({
  meta: {
    name: 'arere-plugin-example',
    version: '1.0.0',
    description: 'Example plugin',
  },
  actions: ['actions/hello.ts'],
  configSchema: z.object({
    greeting: z.string().default('Hello').describe('挨拶メッセージ'),
    maxRetries: z.number().min(1).max(10).default(3).describe('最大リトライ回数'),
    enableDebug: z.boolean().default(false).describe('デバッグモード'),
    theme: z.enum(['light', 'dark', 'auto']).default('auto').describe('テーマ'),
    apiKey: z.string().optional().describe('APIキー（オプション）'),
  }),
})
```

Zodの詳細は [Zod公式ドキュメント](https://zod.dev/) を参照してください。

## アクションでの使用

`pluginConfig` から設定値を取得します：

```typescript
// actions/hello.ts
import { defineAction } from 'arere'

export default defineAction({
  name: 'hello',
  description: '挨拶する',
  async run({ tui, pluginConfig }) {
    const greeting = pluginConfig?.greeting || 'Hello'
    const debug = pluginConfig?.enableDebug ?? false

    if (debug) {
      tui.output.info('Debug mode enabled')
    }

    tui.output.log(`${greeting}, World!`)
  },
})
```

## ユーザーによる設定

ユーザーは `.arere/settings.json` でプラグイン設定を変更できます：

```json
{
  "plugins": {
    "arere-plugin-example": {
      "enabled": true,
      "config": {
        "greeting": "こんにちは",
        "maxRetries": 5,
        "enableDebug": true
      }
    }
  }
}
```

設定はスキーマに対してバリデーションされ、不正な値はエラーになります。

---

## 次のステップ

- [公開・配布](./publishing.md) - npmへの公開方法
- [Plugin API](/api/plugin) - 詳細なAPI仕様
