---
title: Shell Commands
description: How to execute shell commands and use external libraries
---

# Shell Commands

## Basic Usage

You can execute shell commands using `$`:

```typescript
// ~/.arere/git-status.ts
import { defineAction } from 'arere'

export default defineAction({
  name: 'git-status',
  description: 'Display Git status',
  category: 'git',
  async run({ $, tui }) {
    // Execute command
    const { stdout } = await $`git status --short`

    tui.output.log(stdout)
  }
})
```

## Error Handling

Handling when a command fails:

```typescript
// ~/.arere/check-git.ts
import { defineAction } from 'arere'

export default defineAction({
  name: 'check-git',
  description: 'Check if Git repository',
  async run({ $, tui }) {
    const result = await $`git status`
    if (result.exitCode === 0) {
      tui.output.success('This is a Git repository')
    } else {
      tui.output.error('This is not a Git repository')
    }
  }
})
```

::alert{type="info"}
Shell commands do not throw errors. Check success/failure with `result.exitCode`.
::

## Practical Example: Git Commit

```typescript
// ~/.arere/git-commit.ts
import { defineAction } from 'arere'

export default defineAction({
  name: 'git-commit',
  description: 'Create a Git commit',
  category: 'git',
  async run({ $, tui }) {
    // Check staged files
    const { stdout } = await $`git diff --cached --name-only`
    const files = stdout.split('\n').filter(Boolean)

    if (files.length === 0) {
      tui.output.warn('No staged files')
      return
    }

    tui.output.info('Changed files:')
    files.forEach(f => tui.output.log(`  - ${f}`))

    // Input commit message
    const message = await tui.prompt.text('Commit message:', {
      validate: v => v.length > 0 || 'Please enter a message',
    })

    // Confirmation
    const confirmed = await tui.prompt.confirm(`Commit with "${message}"?`, { defaultValue: true })

    if (!confirmed) {
      tui.output.warn('Cancelled')
      return
    }

    // Execute commit
    await $`git commit -m ${message}`
    tui.output.success('Commit completed')
  }
})
```

---

## Using External Libraries

You can use external libraries from actions.

### Global Installation

```bash
npm install -g date-fns chalk
```

### Using in Actions

```typescript
// ~/.arere/format-date.ts
import { defineAction } from 'arere'

export default defineAction({
  name: 'format-date',
  description: 'Format current time',
  async run({ tui }) {
    // Dynamic import of external library
    const { format } = await import('date-fns')
    const chalk = (await import('chalk')).default

    const now = new Date()
    const formatted = format(now, 'yyyy-MM-dd HH:mm:ss')

    tui.output.log(chalk.blue(`Current time: ${formatted}`))
  }
})
```

### HTTP Requests

```typescript
// ~/.arere/fetch-weather.ts
import { defineAction } from 'arere'

export default defineAction({
  name: 'fetch-weather',
  description: 'Fetch weather information',
  async run({ tui }) {
    const city = await tui.prompt.text('Enter city name:', {
      defaultValue: 'Tokyo',
    })

    // Using fetch API
    const response = await fetch(
      `https://wttr.in/${city}?format=3`
    )
    const weather = await response.text()

    tui.output.log(weather)
  }
})
```

---

## Next Steps

- [Advanced Techniques](./05.advanced) - Progress display, CI/CD, i18n
- [Shell API](/en/api/shell) - Detailed reference
