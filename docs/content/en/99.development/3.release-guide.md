---
title: Release Guide
description: How to release Arere packages to npm
---

# Release Guide

## Overview

Arere uses a **manual trigger workflow** for releases. This approach provides:

- Full control over release timing
- Multi-package support for monorepo
- Dry run option for safety
- Automatic version bumping, changelog updates, and npm publishing

---

## Release Methods

### Method 1: Using Arere Action (Recommended)

Run the release action from the project root:

```bash
npx arere
# Select "release" from the action list
```

The interactive prompts will guide you through:

1. **Package Selection** - Multi-select packages to release
2. **Version Type** - Choose patch, minor, or major
3. **Preview** - Review version changes before proceeding
4. **Dry Run Option** - Test without actually publishing

### Method 2: Using GitHub CLI

Trigger the workflow directly:

```bash
gh workflow run release.yml \
  -f packages=arere \
  -f version=patch \
  -f dry_run=false
```

### Method 3: GitHub Web UI

1. Go to **Actions** tab in GitHub
2. Select **Release** workflow
3. Click **Run workflow**
4. Fill in the inputs and run

---

## Workflow Inputs

| Input | Description | Required | Default |
|-------|-------------|----------|---------|
| `packages` | Comma-separated package names | Yes | `arere` |
| `version` | Version bump type: `patch`, `minor`, `major` | Yes | - |
| `dry_run` | Skip actual publish | No | `false` |

### Examples

**Release single package:**
```bash
gh workflow run release.yml -f packages=arere -f version=patch
```

**Release multiple packages:**
```bash
gh workflow run release.yml -f packages=arere,arere-plugin-timer -f version=minor
```

**Dry run (test without publishing):**
```bash
gh workflow run release.yml -f packages=arere -f version=patch -f dry_run=true
```

---

## What the Workflow Does

1. **Checkout** - Fetches repository with full history
2. **Setup** - Configures Node.js and npm registry
3. **Test** - Runs all tests
4. **Build** - Builds all packages
5. **Version Bump** - Updates `package.json` version
6. **Changelog** - Adds release notes to `CHANGELOG.md`
7. **Commit & Tag** - Creates commit and version tags
8. **Push** - Pushes changes and tags to main
9. **GitHub Release** - Creates release with auto-generated notes
10. **npm Publish** - Publishes to npm registry

---

## Monitoring Releases

After triggering a release:

```bash
# Watch the workflow progress
gh run watch

# List recent runs
gh run list --workflow=release.yml

# View workflow logs
gh run view <run-id> --log
```

---

## Versioning Guidelines

Follow [Semantic Versioning](https://semver.org/):

| Type | When to Use | Example |
|------|-------------|---------|
| `patch` | Bug fixes, documentation | `0.1.5` → `0.1.6` |
| `minor` | New features (backward compatible) | `0.1.5` → `0.2.0` |
| `major` | Breaking changes | `0.1.5` → `1.0.0` |

### Pre-release Note

During pre-release (v0.x.x), breaking changes may occur in minor versions. After v1.0.0, semantic versioning will be strictly enforced.

---

## Troubleshooting

### Workflow Failed

1. Check the workflow logs: `gh run view <run-id> --log`
2. Common issues:
   - **Test failures** - Fix tests before releasing
   - **Build errors** - Ensure `npm run build` works locally
   - **npm auth** - Verify `NPM_TOKEN` secret is set

### Wrong Version Released

If you need to unpublish (within 72 hours):

```bash
npm unpublish arere@<version>
```

Then fix and re-release with the correct version.

### Dry Run First

Always use dry run for major releases:

```bash
gh workflow run release.yml -f packages=arere -f version=major -f dry_run=true
```

---

## Required Secrets

The workflow requires these repository secrets:

| Secret | Description |
|--------|-------------|
| `NPM_TOKEN` | npm access token with publish permission |
| `GITHUB_TOKEN` | Automatically provided by GitHub Actions |

### Setting up NPM_TOKEN

1. Go to [npmjs.com](https://www.npmjs.com/) → Access Tokens
2. Create a new **Automation** token
3. Add to repository: Settings → Secrets → Actions → New secret

---

## Security

The release workflow is protected by GitHub's permission system:

- Only users with **write access** can trigger `workflow_dispatch`
- External contributors cannot trigger releases
- For additional security, add an `environment` with required reviewers
