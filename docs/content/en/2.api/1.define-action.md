---
title: defineAction API
description: API reference for the defineAction function to define actions
---

# defineAction API

Define actions using the `defineAction` function.

## Import

```typescript
import { defineAction } from 'arere'
```

## Syntax

```typescript
function defineAction(config: ActionDefinition): Action
```

## Parameters

### `config: ActionDefinition`

Action configuration object:

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `name` | `string` | ✅ | Unique action name. Only alphanumeric, dashes, and underscores allowed |
| `description` | `string \| (context: ActionContext) => string` | ✅ | Action description (displayed in UI). Can be a string or function |
| `category` | `string` | ❌ | Action category (used for grouping) |
| `tags` | `string[]` | ❌ | Action tags (e.g., `['git', 'status']`). Displayed as `[tag1,tag2]` format in UI |
| `run` | `function` | ✅ | Action execution function |

### `run` Function

```typescript
async run(context: ActionContext): Promise<void>
```

**Context Object**:

| Property | Type | Description |
|----------|------|-------------|
| `tui` | `TuiAPI` | TUI API (includes `prompt`, `output`, `control`) |
| `$` | `ShellExecutor` | Shell command execution function |
| `t` | `Function` | Translation function (i18n support) |
| `cwd` | `string` | Current working directory |
| `env` | `Record<string, string \| undefined>` | Environment variables |
| `config` | `ArereConfig` | Access to app configuration |
| `pluginConfig` | `unknown` | Access to plugin configuration (plugin actions only) |
| `args` | `string[]` | CLI arguments (available via `arere run <action> [args...]`) |

## Return Value

Returns an `Action` object.

## Examples

### Basic Usage

```typescript
import { defineAction } from 'arere'

export default defineAction({
  name: 'hello',
  description: 'Display Hello World',
  async run({ tui }) {
    tui.output.log('Hello, World!')
  },
})
```

### Using Prompts

```typescript
import { defineAction } from 'arere'

export default defineAction({
  name: 'greet',
  description: 'Greet someone',
  async run({ tui }) {
    const name = await tui.prompt.text('What is your name?', {
      placeholder: 'John Doe',
    })

    tui.output.success(`Hello, ${name}!`)
  },
})
```

### Shell Command Execution

```typescript
import { defineAction } from 'arere'

export default defineAction({
  name: 'git-status',
  description: 'Display Git status',
  category: 'git',
  async run({ tui, $ }) {
    const { stdout } = await $`git status --short`
    tui.output.log(stdout)
  },
})
```

### CLI Arguments

Actions can receive command-line arguments when run via `arere run`:

```bash
arere run deploy production --force
```

```typescript
import { defineAction } from 'arere'

export default defineAction({
  name: 'deploy',
  description: 'Deploy to target environment',
  async run({ args, tui }) {
    // args = ['production', '--force']
    const target = args[0] || 'staging'
    const force = args.includes('--force')

    tui.output.info(`Deploying to ${target}...`)
    if (force) {
      tui.output.warn('Force mode enabled')
    }

    // ... deployment logic
    tui.output.success(`Deployed to ${target}!`)
  },
})
```

::callout{type="info"}
When running from TUI (interactive mode), `args` is an empty array `[]`.
::


### i18n Support (Function-style description)

```typescript
import { defineAction } from 'arere'

export default defineAction({
  name: 'demo-plugin-i18n',
  description: ({ t }) => t('actions.demo.description', { ns: 'my-plugin' }),
  async run({ tui, t }) {
    const greeting = t('greeting', { ns: 'my-plugin' })
    tui.output.log(greeting)
  },
})
```

### Complex Example

```typescript
import { defineAction } from 'arere'

export default defineAction({
  name: 'git-commit',
  description: 'Create a Git commit',
  category: 'git',
  async run({ tui, $ }) {
    // Check staged files
    const { stdout } = await $`git diff --cached --name-only`
    const stagedFiles = stdout.split('\n').filter(Boolean)

    if (stagedFiles.length === 0) {
      tui.output.warn('No staged files')
      return
    }

    tui.output.log('Staged files:')
    for (const file of stagedFiles) {
      tui.output.log(`  - ${file}`)
    }

    // Input commit message
    const message = await tui.prompt.text('Commit message:', {
      validate: (value) => {
        if (value.length === 0) {
          return 'Please enter a commit message'
        }
        if (value.length < 3) {
          return 'Commit message must be at least 3 characters'
        }
        return true
      },
    })

    // Confirmation
    const confirmed = await tui.prompt.confirm(
      `Commit with "${message}"?`,
      { defaultValue: true }
    )

    if (!confirmed) {
      tui.output.warn('Cancelled')
      return
    }

    // Execute commit
    await $`git commit -m ${message}`
    tui.output.success('Commit completed')
  },
})
```

## Error Handling

`defineAction` throws an error in the following cases:

- `name` is not specified or is an empty string
- `name` contains invalid characters (other than alphanumeric, dashes, underscores)
- `description` is not specified or is an empty string
- `run` is not a function

```typescript
// ❌ Error: Invalid name
defineAction({
  name: 'hello world', // Spaces not allowed
  description: 'Hello',
  run: async () => {},
})

// ❌ Error: run not specified
defineAction({
  name: 'hello',
  description: 'Hello',
})

// ✅ Correct
defineAction({
  name: 'hello-world', // Dashes are OK
  description: 'Hello World',
  run: async () => {},
})
```

## Type Definitions

```typescript
interface ActionDefinition {
  name: string
  description: string | ((context: ActionContext) => string)
  category?: string
  tags?: string[]
  run: (context: ActionContext) => Promise<void>
}

interface Action {
  meta: ActionMeta
  filePath: string
  location?: ActionLocation  // 'project' | 'global' | { plugin: string }
  run: (context: ActionContext) => Promise<void>
}

interface ActionContext {
  tui: TuiAPI
  $: ShellExecutor
  t: TranslationFunction
  cwd: string
  env: Record<string, string | undefined>
  config: ArereConfig
  pluginConfig?: unknown
  args: string[]
}
```

## References

- [prompt API](./prompt.md) - Details on prompt functions
- [$ (shell) API](./shell.md) - Details on shell execution
- [Action Creation Tutorial](/guides/actions/creating)
