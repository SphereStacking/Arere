# 実装プラン作成ガイド

このコマンドは、新しい機能や改善を実装する際のプランニングガイドです。

## 重要

- 実装は明確に開始の合図があるまでは、プランニングを続けてください。
- リリース前のため大胆な設計変更が可能です
- 設計変更に伴う後方互換は必要ありません。クリーンな実装をお願いします。



## プラン作成の流れ

### 1. プランファイルを作成

新しいフェーズを `plan/` ディレクトリに作成します：

```bash
plan/
├── phase-0-foundation.md          # 基盤構築（完了）
├── phase-1-core.md                # コア機能（完了）
├── ...
└── phase-XX-new-feature.md        # 次の機能（新規作成）
```

### 2. テンプレートを使用

以下のテンプレートに従ってプランを作成します。

### 3. 仕様書の参照

現在の仕様書は以下を参照：
- **アーキテクチャ**: `docs/content/ja/3.development/1.architecture-guide.md`
- **テスト**: `docs/content/ja/3.development/2.testing-guide.md`
- **CLAUDE.md**: プロジェクト概要と開発ポリシー

## タスクファイルのテンプレート

各フェーズファイルは以下のテンプレートに従って作成します：

```markdown
# フェーズX: [フェーズ名]

## プランニングステータス

**重要**
必ずこちらが承認されている場合のみ実装を開始すること

- **ステータス**: プランニング中/承認/却下/ペンディング



## 概要
- **目的**: このフェーズで達成すること
- **前提条件**: 必要な前フェーズ
- **参照ドキュメント**:
  - 主要: [ドキュメント名](パス)
  - 補助: [ドキュメント名](パス)
- **推定期間**: X日
- **ステータス**: ⚪ 未着手

## タスクリスト

### セクション1: [セクション名]

#### タスク1.1: [タスク名]
- **詳細**: 具体的な作業内容
- **仕様参照**: [該当セクション名](ドキュメントパス#セクション)
- **見積**: Xh
- **実績**: -
- **ステータス**: ⚪
- **成果物**:
  - `path/to/file.ts`

#### タスク1.2: [タスク名]
- **詳細**: 具体的な作業内容
- **仕様参照**: [該当セクション名](ドキュメントパス#セクション)
- **見積**: Xh
- **実績**: -
- **ステータス**: ⚪
- **成果物**:
  - `path/to/file.ts`

## 成果物一覧
- ディレクトリ/ファイルのリスト
- 設定ファイル
- ドキュメント

## 受入条件
- [ ] 条件1: 具体的な確認項目
- [ ] 条件2: 具体的な確認項目
- [ ] 条件3: 具体的な確認項目

## 依存関係
- **前提**: フェーズX完了
- **ブロッカー**: なし
- **次フェーズ**: フェーズY

## メモ
- 注意事項
- 参考リンク
- 決定事項
```

## ステータス記号

- ⚪ 未着手
- 🟡 進行中
- 🟢 完了
- 🔴 ブロック

## プランニングのベストプラクティス

### 1. アーキテクチャを考慮

新機能を追加する際は、Clean Architecture のどの層に配置すべきか検討：
- **Domain層**: ビジネスロジック
- **Infrastructure層**: 外部システム連携
- **Application層**: ユースケース調整
- **Presentation層**: UI

参考: [アーキテクチャガイド](../../docs/content/ja/3.development/1.architecture-guide.md)

### 2. テストファースト

TDD原則に従い、テストを含めたタスクを計画：
- テストケースの洗い出し
- モック戦略の検討
- カバレッジ目標の設定

参考: [テストガイド](../../docs/content/ja/3.development/2.testing-guide.md)

### 3. 小さく分割

大きな機能は小さなタスクに分割：
- 1タスク = 1-4時間
- 独立してテスト可能
- レビューしやすい単位

### 4. 成果物を明確に

各タスクで何を作るのか明確に：
- ファイルパス
- 型定義
- テストファイル
- ドキュメント更新

### 5. 受入条件を定義

フェーズ完了の基準を明確に：
- テストが通る
- 型チェックが通る
- カバレッジが目標に達する
- ドキュメントが更新されている

## 実装の進め方

### 1. プラン作成
```
新しい機能 → plan/phase-X-feature.md 作成
```

### 2. タスク実行
```
タスク1.1 → 実装 → テスト → ステータス更新
```

### 3. レビュー
```
タスク完了 → 受入条件確認 → 次タスクへ
```

### 4. フェーズ完了
```
全タスク完了 → ドキュメント更新 → 次フェーズへ
```

## 注意事項

### アーキテクチャ変更時
- アーキテクチャガイドを先に更新
- 影響範囲を明確に
- 既存コードの移行計画も立てる

### テスト方針変更時
- テストガイドを先に更新
- 既存テストへの影響を確認
- 移行期間を設ける

### ドキュメント更新を忘れない
- CLAUDE.md は概要のみ
- 詳細は development guide に集約
- 相互リンクを活用

## 参考: 過去のフェーズ

完了済みのフェーズ例：
- **Phase 0-22**: 基盤構築、コア機能、UI実装、プラグインシステム
- **Phase 23**: Script → Action リネーム（250+ occurrences）
- **Phase 39**: Settings Layer Selector UI
- **Phase 40**: Partial Config Save
- **Phase 43**: Clean Architecture / レイヤー分離

詳細は `plan/` ディレクトリを参照してください。
